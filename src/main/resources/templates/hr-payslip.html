<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LogSphere - Payslip</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <style>
        @media print {
            .no-print { display: none !important; }
            body { background: white !important; }
            .payslip-container { box-shadow: none !important; }
        }
        .payslip-container {
            background: white;
            color: #000;
            padding: 30px;
            max-width: 800px;
            margin: 20px auto;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
        }
        .payslip-header {
            border-bottom: 3px solid #ffc107;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        .payslip-section {
            margin-bottom: 25px;
        }
        .payslip-table {
            width: 100%;
            border-collapse: collapse;
        }
        .payslip-table th, .payslip-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        .payslip-table th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        .text-right {
            text-align: right;
        }
        .total-row {
            font-weight: bold;
            font-size: 18px;
            background-color: #fff3cd;
        }
    </style>
</head>
<body class="bg-dark">
    <div class="no-print text-center mt-3 mb-3">
        <a href="/hr/dashboard" class="btn btn-secondary me-2">Back to Dashboard</a>
        <button onclick="window.print()" class="btn btn-warning">üñ®Ô∏è Print Payslip</button>
    </div>

    <div class="payslip-container">
        <div class="payslip-header text-center">
            <h1 class="text-warning mb-2">LogSphere</h1>
            <h3>PAYSLIP</h3>
            <p class="mb-0" th:text="${#temporals.format(payroll.payPeriodStart, 'MMMM yyyy')}"></p>
        </div>

        <div class="payslip-section">
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Employee Name:</strong> <span th:text="${payroll.employee.name}"></span></p>
                    <p><strong>Employee ID:</strong> <span th:text="${payroll.employee.employeeId}"></span></p>
                    <p><strong>Department:</strong> <span th:text="${payroll.employee.department}"></span></p>
                </div>
                <div class="col-md-6">
                    <p><strong>Pay Period:</strong> 
                        <span th:text="${#temporals.format(payroll.payPeriodStart, 'dd MMM yyyy')} + ' to ' + ${#temporals.format(payroll.payPeriodEnd, 'dd MMM yyyy')}"></span>
                    </p>
                    <p><strong>Payment Date:</strong> 
                        <span th:text="${payroll.paymentDate != null ? #temporals.format(payroll.paymentDate, 'dd MMM yyyy') : 'Pending'}"></span>
                    </p>
                    <p><strong>Status:</strong> <span th:text="${payroll.status}"></span></p>
                </div>
            </div>
        </div>

        <div class="payslip-section">
            <h5 class="mb-3">EARNINGS</h5>
            <table class="payslip-table">
                <thead>
                    <tr>
                        <th>Description</th>
                        <th class="text-right">Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Base Salary</td>
                        <td class="text-right" th:text="'‚Çπ' + ${#numbers.formatDecimal(payroll.baseSalary, 0, 2)}"></td>
                    </tr>
                    <tr th:if="${payroll.bonus > 0}">
                        <td>Bonus</td>
                        <td class="text-right" th:text="'‚Çπ' + ${#numbers.formatDecimal(payroll.bonus, 0, 2)}"></td>
                    </tr>
                    <tr th:if="${payroll.incentive > 0}">
                        <td>Incentive</td>
                        <td class="text-right" th:text="'‚Çπ' + ${#numbers.formatDecimal(payroll.incentive, 0, 2)}"></td>
                    </tr>
                    <tr th:if="${payroll.overtimePay > 0}">
                        <td>Overtime Pay</td>
                        <td class="text-right" th:text="'‚Çπ' + ${#numbers.formatDecimal(payroll.overtimePay, 0, 2)}"></td>
                    </tr>
                    <tr th:if="${payroll.allowances > 0}">
                        <td>Allowances</td>
                        <td class="text-right" th:text="'‚Çπ' + ${#numbers.formatDecimal(payroll.allowances, 0, 2)}"></td>
                    </tr>
                    <tr class="total-row">
                        <td><strong>Gross Salary</strong></td>
                        <td class="text-right">
                            <strong th:text="'‚Çπ' + ${#numbers.formatDecimal(payroll.baseSalary + payroll.bonus + payroll.incentive + payroll.overtimePay + payroll.allowances, 0, 2)}"></strong>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="payslip-section">
            <h5 class="mb-3">DEDUCTIONS</h5>
            <table class="payslip-table">
                <thead>
                    <tr>
                        <th>Description</th>
                        <th class="text-right">Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:if="${payroll.taxDeduction > 0}">
                        <td>Tax Deduction</td>
                        <td class="text-right" th:text="'‚Çπ' + ${#numbers.formatDecimal(payroll.taxDeduction, 0, 2)}"></td>
                    </tr>
                    <tr th:if="${payroll.otherDeductions > 0}">
                        <td>Other Deductions</td>
                        <td class="text-right" th:text="'‚Çπ' + ${#numbers.formatDecimal(payroll.otherDeductions, 0, 2)}"></td>
                    </tr>
                    <tr th:if="${payroll.taxDeduction == 0 && payroll.otherDeductions == 0}">
                        <td colspan="2" class="text-center text-muted">No deductions</td>
                    </tr>
                    <tr class="total-row">
                        <td><strong>Total Deductions</strong></td>
                        <td class="text-right">
                            <strong th:text="'‚Çπ' + ${#numbers.formatDecimal(payroll.taxDeduction + payroll.otherDeductions, 0, 2)}"></strong>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="payslip-section" style="background: #fff3cd; padding: 20px; border-radius: 5px;">
            <div class="row">
                <div class="col-md-6">
                    <h4>NET SALARY</h4>
                </div>
                <div class="col-md-6 text-right">
                    <h3 class="text-warning" th:text="'‚Çπ' + ${#numbers.formatDecimal(payroll.netSalary, 0, 2)}"></h3>
                </div>
            </div>
        </div>

        <div class="payslip-section text-center mt-4">
            <p class="text-muted">This is a computer-generated payslip. No signature required.</p>
            <p class="text-muted">Generated on: <span th:text="${#temporals.format(#temporals.createNow(), 'dd MMM yyyy HH:mm')}"></span></p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

