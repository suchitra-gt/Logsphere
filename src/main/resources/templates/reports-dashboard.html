<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LogSphere - Reports</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>
<body class="bg-dark text-light">
    <nav class="navbar navbar-dark bg-black p-3">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1 text-warning">LogSphere - Reports</span>
            <div>
                <a href="/admin/dashboard" class="text-light text-decoration-none me-3">Dashboard</a>
                <a href="/logout" class="btn btn-outline-danger btn-sm">Logout</a>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <h2 class="text-warning mb-4">Reports & Analytics</h2>

        <!-- Report Type Selection -->
        <div class="card bg-black mb-4 shadow">
            <div class="card-header bg-dark">
                <h4 class="text-warning mb-0">Select Report Type</h4>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="card bg-dark p-3">
                            <h5 class="text-warning">Employee Work Hours Report</h5>
                            <p class="text-secondary">View employee attendance and work hours</p>
                            <div class="btn-group" role="group">
                                <a href="/reports/employee?period=daily" class="btn btn-outline-warning btn-sm">Daily</a>
                                <a href="/reports/employee?period=weekly" class="btn btn-outline-warning btn-sm">Weekly</a>
                                <a href="/reports/employee?period=monthly" class="btn btn-outline-warning btn-sm">Monthly</a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <div class="card bg-dark p-3">
                            <h5 class="text-warning">Visitor Flow Report</h5>
                            <p class="text-secondary">Analyze visitor patterns and flow</p>
                            <div class="btn-group" role="group">
                                <a href="/reports/visitor?period=daily" class="btn btn-outline-warning btn-sm">Daily</a>
                                <a href="/reports/visitor?period=weekly" class="btn btn-outline-warning btn-sm">Weekly</a>
                                <a href="/reports/visitor?period=monthly" class="btn btn-outline-warning btn-sm">Monthly</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Today's Summary -->
        <div class="row mb-4">
            <div class="col-md-4">
                <div class="card bg-black shadow">
                    <div class="card-body text-center">
                        <h5 class="text-secondary">Today's Attendance</h5>
                        <h2 class="text-success" th:text="${todayAttendance.size()}">0</h2>
                        <small class="text-secondary">Employees</small>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card bg-black shadow">
                    <div class="card-body text-center">
                        <h5 class="text-secondary">Today's Work Hours</h5>
                        <h2 class="text-warning" th:text="${#numbers.formatDecimal(todayTotalHours, 1, 1)} + 'h'">0h</h2>
                        <small class="text-secondary">Total hours</small>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card bg-black shadow">
                    <div class="card-body text-center">
                        <h5 class="text-secondary">Today's Visitors</h5>
                        <h2 class="text-info" th:text="${todayVisitors.size()}">0</h2>
                        <small class="text-secondary">Total visitors</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Weekly Summary -->
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card bg-black shadow">
                    <div class="card-header bg-dark">
                        <h5 class="text-warning mb-0">Weekly Summary</h5>
                    </div>
                    <div class="card-body">
                        <p><strong>Total Work Hours:</strong> <span class="text-warning" th:text="${#numbers.formatDecimal(weeklyTotalHours, 1, 1)} + ' hours'">0 hours</span></p>
                        <p><strong>Total Visitors:</strong> <span class="text-info" th:text="${weeklyVisitors.size()}">0</span></p>
                        <p><strong>Attendance Records:</strong> <span class="text-success" th:text="${weeklyAttendance.size()}">0</span></p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card bg-black shadow">
                    <div class="card-header bg-dark">
                        <h5 class="text-warning mb-0">Monthly Summary</h5>
                    </div>
                    <div class="card-body">
                        <p><strong>Total Work Hours:</strong> <span class="text-warning" th:text="${#numbers.formatDecimal(monthlyTotalHours, 1, 1)} + ' hours'">0 hours</span></p>
                        <p><strong>Total Visitors:</strong> <span class="text-info" th:text="${monthlyVisitors.size()}">0</span></p>
                        <p><strong>Attendance Records:</strong> <span class="text-success" th:text="${monthlyAttendance.size()}">0</span></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Custom Date Range -->
        <div class="card bg-black shadow">
            <div class="card-header bg-dark">
                <h4 class="text-warning mb-0">Custom Date Range Report</h4>
            </div>
            <div class="card-body">
                <form method="get" id="customReportForm" class="row g-3">
                    <div class="col-md-4">
                        <label class="form-label">Start Date</label>
                        <input type="date" name="startDate" class="form-control bg-dark text-light" required>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">End Date</label>
                        <input type="date" name="endDate" class="form-control bg-dark text-light" required>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label">Report Type</label>
                        <select name="type" id="reportType" class="form-select bg-dark text-light" required>
                            <option value="employee">Employee Report</option>
                            <option value="visitor">Visitor Report</option>
                        </select>
                    </div>
                    <div class="col-12">
                        <button type="submit" class="btn btn-warning">Generate Report</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Handle custom date range report form submission
        document.getElementById('customReportForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const reportType = document.getElementById('reportType').value;
            const form = this;
            const formData = new FormData(form);
            const startDate = formData.get('startDate');
            const endDate = formData.get('endDate');
            
            // Redirect to the appropriate report endpoint based on selected type
            if (reportType === 'visitor') {
                window.location.href = `/reports/visitor?startDate=${startDate}&endDate=${endDate}`;
            } else {
                window.location.href = `/reports/employee?startDate=${startDate}&endDate=${endDate}`;
            }
        });
    </script>
</body>
</html>

